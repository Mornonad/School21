# Итоговый проект

## Прототип рекомендательного сервиса рецептов.

+ Цель и задачи проекта

Основная цель данного проекта - закрепить все навыки, 
которые были приобретены  в ходе выполнения предыдущих задач.

В рамках этого проекта необходимо решить не просто задачу машинного обучения или анализа данных, а сделать продукт на их основе. Точнее – его прототип.

Это будет собственное приложение, которое поможет людям потреблять более здоровую и вкусную пищу. 


### Этапы разработки

Работа была разделена на три этапа: 
- исследование (с помощью Jupyter Notebook), 
- разработка (организация всех элементов в рамках одного модуля, содержащего классы и методы - PyCharm),
- работа с самой программой (запуск скрипта Python - PyCharm). 


#### 1. Основная программа

Программа представляет собой скрипт на языке Python (`nutritionist.py`).
1. Она принимает на вход список ингредиентов.
2. Она создает прогноз и выдает рейтинг с оценкой (`невкусное`, `нормальное`, `вкусное`) блюда, которое можно приготовить на основе списка переданных ингредиентов.
3. Она находит и выводит информацию обо всех питательных веществах (белках, жирах, натрии и т. д.) продуктов из списка, а также их объем в процентах от суточной нормы потребления.
4. Она отображает три рецепта блюд, в которых используется максимальное количество продуктов из списка, с указанием их оценки и ссылок, по которым пользователь сможет найти полную информацию.

Пример работы программы:


#### 2. Разработка

Модуль Python (`recipes.py`) содержит все классы и методы, которые используются в основной программе.


#### 3. Исследование
В этой части проекта идет подготовка всего, что используется в классах и методах, описанных выше, в Jupyter Notebook (`recipes.ipynb`). 

##### 3.1. Прогноз
1. Подготовка данных
    Используется датасет из Epicurious, подготовленный HugoDarwood
	-Удалены дубликаты и поля с пустыми значениями,
	-удалено 337столбцов, которые не относятся к названиями ингридиентов. 
	Это необходимо для прогнозирования оценки или категории оценки.  
Если модель обучится на других данных, которые не будут передаваться на вход, то точность прогнозов будет заведомо ниже.

2. Регрессия
    Для прогнозирования рейтинга были опробованы различные алгоритмы и их гиперпараметры:
	Линейная регрессия
	Дерева решений регрессии 
	Случайный лес регрессии

Ансамбли:
	VotingRegressor
	BaggingRegressor
	StackingRegressor

На основе gridsearch и кроссвалидации было выбрано лучшее решение RandomForestRegressor и BaggingRegressor среди ансамблей. RMSE посчитан на тестовой подвыборке и для наивного регрессора.

3. Бинаризация
	- Для классификации значения целевой переменной были изменены  путем округления рейтингов до ближайшего целого числа.
	- Преобразование целых чисел в классы bad (0, 1) (невкусное), so-so (2, 3) (нормальное), great (4, 5) (вкусное)


4. Классификация
    Для прогнозирования рейтинга были опробованы различные алгоритмы и их гиперпараметры:
	Логистическая регрессия
	Метод опорных векторов
	Дерево решений 
	Случайный лес

    Ансамбли:
	VotingClassifier
	BaggingClassifier
	StackingClassifier

На основе gridsearch и кроссвалидации было выбрано лучшее решение RandomForestClassifier и BaggingClassifier среди ансамблей. 
Accuracy посчитан на тестовой подвыборке и для наивного регрессора.


4. Принятие решения
    - Было принято решение использовать классификацию  случайный лес.
 Сохранение выбранной модели для использования в основной программе.

##### 3.2. Пищевая ценность
	- Вся  информация о пищевой ценности продуктов из подготовленного вами и отфильтрованного набора данных (только столбцы с продуктами) были собраны в датафрейм. Для этого использовался  следующий API.
	- Все значения были конвертированы в % от суточной нормы потребления. Сохранены только те ингридиенты, которые находятся в э таблицах.
	- Измененный датафрейм сохранен в CSV-файл, который будет использован в основной программе.



##### 3.3. Похожие рецепты
	- Для каждого рецепта из набора данных были собраны ссылки на сайте epicurious.com и подробная информацию о нем (название рецепта, рейтинг на платформе и URl). 
	- Если сделать это не удалось, добавлена ссылка на поиск рецепта в google.
	- Новый датафрейм также сохранен  в CSV-файл.

### Бонусная часть
 Составление меню на день.
